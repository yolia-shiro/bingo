var name;var sort;var order;var pageIndex;var price_sort=0;var category;var tag;var minPrice;var maxPrice;var area;var language;$(document).ready(function(){name=searchCondition.name;sort=searchCondition.sort;order=searchCondition.order;pageIndex=searchCondition.pageIndex;price_sort=0;if(searchCondition.category!==undefined){category=JSON.parse(searchCondition.category)}else{category=[]}if(searchCondition.tag!==undefined){tag=JSON.parse(searchCondition.tag)}else{tag=[]}minPrice=searchCondition.minPrice;maxPrice=searchCondition.maxPrice;area=searchCondition.area;language=searchCondition.language;getGameList(searchCondition)});function setPage(a){var c="";if(a===0){$(".pagination").html("");return}for(var b=0;b<a;b++){if(b===parseInt(pageIndex/10)){c+='<button class="page-item active-button">'+parseInt(b+1).toString()+"</button>"}else{c+='<button class="page-item">'+parseInt(b+1).toString()+"</button>"}}$(".page-list").empty();$(".page-list").html(c)}function getGameList(a){if(isSearchResult===true){$.post(requestmap.store_search,searchCondition,function(b){let gamel=b.resultMap.searchList;let html="";$("#game-list").empty();if(b.status===0){return}for(let i=0;i<gamel.length;i++){let game=gamel[i]let temp=(parseFloat(game.gprice)*(parseFloat(game.discount))).toString();if(temp.length>6){temp.substr(0,6)}let typelist=game.gtype;typelist=(typelist!=null?typelist.substring(1,typelist.length-1):"");typelist=typelist.split(",");let languagelist=game.language;languagelist=(languagelist!=null?languagelist.substring(1,languagelist.length-1):"");languagelist=languagelist.split(",");for(let j=0;j<languagelist.length;j++){languagelist[j].substring(1,languagelist[j].length-1)}html+="<li><a href=/game_detail.html?gid="+game.gid+" class=game-click target=_black><div class=left><img src="+game.chref+"></div><div class=right>";if(game.discount!=1&&game.discount!=null){html+="<span class=game-discount>-"+((1-game.discount)*100).toFixed()+"%</span><span class=game-origin-price>￥"+game.gprice+"</span>"}html+="<span class=game-sale-price>￥"+temp+"</span></div><div class=middle><p class=title>"+game.gname;if(game.discount!=1){html+="<span class=title-tag>促销</span>"}var c=false;for(var d=0;d<languagelist.length;d++){if(languagelist[d]==='"中文"'&&languagelist.length==1){html+="<span class=title-area>中国站</span>";c=true;break}}if(!c){html+="<span class=title-area>国际站</span>"}html+="</p><p class='date'>发行于"+(game.realeasedate!=null?game.realeasedate.substring(0,10):" ")+"</p><p class='tags'>";for(j=0;j<typelist.length;j++){html+="<span class=tag-block>"+(typelist[j]!=null?typelist[j].substring(1,typelist[j].length-1):" ")+"</span>"}html+="</p></div></a></li>"}$("#game-list").html(html)});isSearchResult=false}else{$.post(requestmap.store_search,a,function(b){let gamel=b.resultMap.searchList;let page=b.resultMap.allSearchNum;let html="";$("#game-list").empty();if(b.status===0){return}for(let i=0;i<gamel.length;i++){let game=gamel[i]let temp=(parseFloat(game.gprice)*(parseFloat(game.discount))).toString();if(temp.length>6){temp.substr(0,6)}let typelist=game.gtype;typelist=(typelist!=null?typelist.substring(1,typelist.length-1):"");typelist=typelist.split(",");let languagelist=game.language;languagelist=(languagelist!=null?languagelist.substring(1,languagelist.length-1):"");languagelist=languagelist.split(",");for(let j=0;j<languagelist.length;j++){languagelist[j].substring(1,languagelist[j].length-1)}html+="<li><a href=/game_detail.html?gid="+game.gid+" class=game-click target='_blank'><div class=left><img src="+game.chref+"></div><div class=right>";if(game.discount!=1&&game.discount!=null){html+="<span class=game-discount>-"+((1-game.discount)*100).toFixed()+"%</span><span class=game-origin-price>￥"+game.gprice+"</span>"}html+="<span class=game-sale-price>￥"+temp+"</span></div><div class=middle><p class=title>"+game.gname;if(game.discount!=1){html+="<span class=title-tag>促销</span>"}var c=false;for(var d=0;d<languagelist.length;d++){if(languagelist[d]==='"中文"'&&languagelist.length==1){html+="<span class=title-area>中国站</span>";c=true;break}}if(!c){html+="<span class=title-area>国际站</span>"}html+="</p><p class='date'>发行于"+(game.realeasedate!=null?game.realeasedate.substring(0,10):" ")+"</p><p class='tags'>";for(j=0;j<typelist.length;j++){html+="<span class=tag-block>"+(typelist[j]!=null?typelist[j].substring(1,typelist[j].length-1):" ")+"</span>"}html+="</p></div></a></li>"}$("#game-list").html(html);setPage(page)})}}$(document).on("click",".page-item",function(){pageIndex=(parseInt($(this).text())-1)*10;let thisFormData={sort:sort,pageIndex:pageIndex,order:order,category:JSON.stringify(category),tag:JSON.stringify(tag),minPrice:minPrice,maxPrice:maxPrice,area:area,language:language}getGameList(thisFormData);$(".active-button").removeClass("active-button");$(this).addClass("active-button")});$(".game-sort-order").on("click",function(){pageIndex=0;if(this.innerText==="全部"){sort=""}else{if(this.innerText==="折扣"){sort="discount"}else{if(this.innerText==="最新"){sort="new"}else{if(this.innerText==="评分"){sort="score"}else{sort="price"}}}}if(sort==="price"){if(price_sort==0){price_sort=1}else{price_sort=0}if(price_sort==1){order="desc";$(".fa").text("▲")}else{order="asc";$(".fa").text("▼")}let thisFormData={sort:sort,pageIndex:pageIndex,order:order,category:JSON.stringify(category),tag:JSON.stringify(tag),minPrice:minPrice,maxPrice:maxPrice,area:area,language:language}getGameList(thisFormData)}else{let thisFormData={sort:sort,pageIndex:pageIndex,order:order,category:JSON.stringify(category),tag:JSON.stringify(tag),minPrice:minPrice,maxPrice:maxPrice,area:area,language:language}getGameList(thisFormData)}$(".condition .active").removeClass("active");$(this).addClass("active")});$(".tags-block-wrapper").on("click",function(){pageIndex=0;var a=$(this).text();var c=a[0];if(c=="√"){var b=a;$(this).text((b!=null?b.substring(1,b.length):""));category.splice($.inArray($(this).text(),category),1)}else{category.push(a);a="√"+a;$(this).text(a)}let thisFormData={sort:sort,pageIndex:pageIndex,order:order,category:JSON.stringify(category),tag:JSON.stringify(tag),minPrice:minPrice,maxPrice:maxPrice,area:area,language:language}getGameList(thisFormData)});$(".tags-block-wrapper1").on("click",function(){pageIndex=0;var a=$(this).text();var b=a;var d=a[0];if(d=="√"){var c=a;$(this).text((c!=null?c.substring(1,c.length):""));tag.splice($.inArray($(this).text(),tag),1)}else{if(a=="预售游戏"){a="presale"}else{if(a=="新品游戏"){a="newsale"}else{a="promotion"}}tag.push(a);a="√"+b;$(this).text(a)}let thisFormData={sort:sort,pageIndex:pageIndex,order:order,category:JSON.stringify(category),tag:JSON.stringify(tag),minPrice:minPrice,maxPrice:maxPrice,area:area,language:language}getGameList(thisFormData)});$(".tags-block-wrapper2").on("click",function(){pageIndex=0;var a=$(this).text();if(a[0]!="√"){for(var b=17;b<=20;b++){var c=$("#fa"+b).text();if(c[0]=="√"){$("#fa"+b).text(c.substring(1,c.length))}}$(this).text("√"+a)}else{$(this).text(a.substring(1,a.length))}switch($(this).text()){case"√￥0-10":minPrice=0;maxPrice=10;break;case"√￥11-50":minPrice=11;maxPrice=50;break;case"√￥51-100":minPrice=51;maxPrice=100;break;case"√>=￥101":minPrice=100;maxPrice=10000;break;default:minPrice=null;maxPrice=null;break}let thisFormData={sort:sort,pageIndex:pageIndex,order:order,category:JSON.stringify(category),tag:JSON.stringify(tag),minPrice:minPrice,maxPrice:maxPrice,area:area,language:language}getGameList(thisFormData)});$(".tags-block-wrapper4").on("click",function(){pageIndex=0;var a=$(this).text();if(a[0]!="√"){for(var b=21;b<=22;b++){var c=$("#fa"+b).text();if(c[0]=="√"){$("#fa"+b).text(c.substr(1,c.length))}}$(this).text("√"+a)}else{$(this).text(a.substring(1,a.length))}switch($(this).text()){case"√中国站":area="China";break;case"√国际站":area="other";break;default:area=null;break}let thisFormData={sort:sort,pageIndex:pageIndex,order:order,category:JSON.stringify(category),tag:JSON.stringify(tag),minPrice:minPrice,maxPrice:maxPrice,area:area,language:language}getGameList(thisFormData)});$(".tags-block-wrapper3").on("click",function(){pageIndex=0;var a=$(this).text();if(a[0]!="√"){for(var b=15;b<=16;b++){var c=$("#fa"+b).text();if(c[0]=="√"){$("#fa"+b).text(c.substring(1,c.length))}}$(this).text("√"+a)}else{$(this).text(a.substring(1,a.length))}switch($(this).text()){case"√中文":language="Chinese";break;case"√英文":language="other";break;default:language=null;break}let thisFormData={sort:sort,pageIndex:pageIndex,order:order,category:JSON.stringify(category),tag:JSON.stringify(tag),minPrice:minPrice,maxPrice:maxPrice,area:area,language:language}getGameList(thisFormData)});