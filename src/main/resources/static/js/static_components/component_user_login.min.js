$(document).ready(function(){let cname="savedAccInfo";let isSaved=false;let savedUname="";let accInfo=getCookie(window.btoa(cname));if(accInfo!==null){let arr=accInfo.split("_");let uname=window.atob(arr[0]);let password=window.atob(arr[1]);$("#user-login-form-uname-input").val(uname);$("#user-login-form-password-input").val(password);isSaved=true;savedUname=arr[0]}$("[data-toggle='tooltip']").tooltip();$("#user-login-form-reset-button").click(function(){$("#user-login-form").data("bootstrapValidator").resetForm(true);$("#user-login-form-remember-checkbox").prop("checked",false);$("#user-login-form-submit-button").button("reset")});$("#user-login-form").bootstrapValidator({message:"*输入不合法",feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{"user-login-form-uname-input":{message:"*用户名不合法",validators:{notEmpty:{message:"*用户名不能为空"},stringLength:{min:6,max:16,message:"*用户名长度为6-16（包含）"},regexp:{regexp:/^[a-zA-Z0-9_.]+$/,message:"*用户名只能包含字母、数字、下划线和点"}}},"user-login-form-password-input":{message:"*密码不合法",validators:{notEmpty:{message:"*密码不能为空"},stringLength:{min:6,max:16,message:"*密码长度为6-16（包含）"},different:{field:"user-login-form-uname-input",message:"*密码不能和用户名相同"}}}}}).on("success.form.bv",function(a){a.preventDefault();$("#user-login-form-submit-button").button("loading");let uname=$("#user-login-form-uname-input").val();let password=$("#user-login-form-password-input").val();let md5_password=md5(password);let data={uname:uname,password:md5_password};$.post(requestmap.user_login,data,function(b){if(b.status===1){if($("#user-login-form-remember-checkbox").prop("checked")){if(!isSaved){let base64_cname=window.btoa(cname);let base64_cvalue=window.btoa(uname)+"_"+window.btoa(password);setCookie(base64_cname,base64_cvalue,72)}else{if(savedUname!==uname){let base64_cname=window.btoa(cname);let base64_cvalue=window.btoa(uname)+"_"+window.btoa(password);setCookie(base64_cname,base64_cvalue,72)}else{}}}savePage("首页");$(window).attr("location","/")}else{myAlert("用户名或密码错误!");$("#user-login-form-submit-button").button("reset")}})})});